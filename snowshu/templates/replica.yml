version: "1"
credpath: "./tests/assets/integration/credentials.yml" ## can be a relative or expandable path
name: integration-test
short_description: this is a sample with LIVE CREDS for integration
long_description: this is for testing against a live db
threads: 15
target:
  adapter: 'postgres'
source:
  profile: default
  sampling: default
  general_relations:
    databases:
    - pattern: 'SNOWSHU_DEVELOPMENT' # matches our test database
      schemas:
      - pattern: '.*' # matches all schemas
        relations:
        - '^(?!.+_VIEW).+$' # matches all relations that do not end with '_VIEW'
  include_outliers: True
  
  # these are exceptions to the 'default' sampling above
  specified_relations: 
  - database: SNOWSHU_DEVELOPMENT
    schema: SOURCE_SYSTEM
    relation: ORDERS
    unsampled: True
  - database: SNOWSHU_DEVELOPMENT
    schema: SOURCE_SYSTEM
    relation: ORDER_ITEMS_VIEW
    unsampled: True
  - database: SNOWSHU_DEVELOPMENT
    schema: TESTS_DATA
    relation: DATA_TYPES
    unsampled: True
      
  - database: SNOWSHU_DEVELOPMENT
    schema: SOURCE_SYSTEM
    relation: '^ORDER_ITEMS$'
    relationships:
      bidirectional: 
      - local_attribute: PRODUCT_ID 
        database: '' ## empty strings inherit from the downstream relation
        schema: ''
        relation: PRODUCTS
        remote_attribute: ID
      directional: 
      - local_attribute: ORDER_ID
        database: SNOWSHU_DEVELOPMENT
        schema: SOURCE_SYSTEM
        relation: ORDERS
        remote_attribute: ID
  - database: SNOWSHU_DEVELOPMENT
    schema: SOURCE_SYSTEM
    relation: 'USER_COOKIES'
    relationships:
      bidirectional: 
      - local_attribute: USER_ID 
        database: '' ## empty strings inherit from the downstream relation
        schema: ''
        relation: 'USERS'
        remote_attribute: ID
  - database: SNOWSHU_DEVELOPMENT
    schema: EXTERNAL_DATA
    relation: 'SOCIAL_USERS_IMPORT'
    sampling:
      default:
        margin_of_error: 0.05
        confidence: 0.95
        min_sample_size: 300

